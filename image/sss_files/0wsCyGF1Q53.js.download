if (self.CavalryLogger) { CavalryLogger.start_js(["nwT6sFS"]); }

__d("MWChatReactionsDialog.bs",["fbt","ActorHovercard.react","CometCardedDialog.react","CometEmoji.bs","CometEntityHeaderTabBar.react","CometLink.react","EmojiRenderer","FBID.bs","MDSTextCommon.react","MWChatMessageId.bs","MWChatReactionsUtils.bs","MWLSActor.bs","MWListCell.bs","MWThread_DEPRECATED.bs","MWUILoadParticipants.bs","MWUISendOrRemoveReaction.bs","ReQL.bs","ReQLSubscription.bs","ReStore.bs","SkytaleDB","TetraAccessoryListCell.react","bs_caml_obj","bs_caml_option","bs_curry","bs_int64","bs_js_dict","bs_js_nlil_undefined","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||b("react");function k(a){var c=a.addOnIcon;a=a.id;return j.jsx(b("TetraAccessoryListCell.react"),{headline:j.jsx(b("MDSTextCommon.react"),{type:"headline4",numberOfLines:1,children:g._("Facebook User")}),testid:"messenger_reaction_actor_"+a,addOnPrimary:{shape:"circle",size:40,source:{uri:b("bs_js_nlil_undefined").fromOption("/images/chat/webrtc/no_profile_pic.png")},type:"profile-photo"},addOnSecondary:b("MWListCell.bs").SecondaryAddOn.body({addOn:c,type:"body"})},a)}c={make:k};function l(a){var c=a.actorId,d=a.profileUrl,e=a.profilePictureUrl,f=a.actualName,h=a.messageID,i=a.reaction,k=a.sendOrRemoveReaction,l=a.currentUserStr;a=a.addOnIcon;l=l===c;var m=l?g._("Click to remove"):void 0;if(l){var n=b("MWChatMessageId.bs").getMessageId(h);l=n!==void 0?function(a){return b("bs_curry")._3(k,n,i,!0)}:void 0}else l=void 0;h={headline:j.jsx(b("ActorHovercard.react"),{actorID:c,children:function(a){if(d!==void 0)return j.jsx(b("CometLink.react"),{href:d,role:"link",label:f,children:j.jsx(b("MDSTextCommon.react"),{type:"headline4",numberOfLines:1,children:f}),ref:a});else return j.jsx(b("MDSTextCommon.react"),{type:"headline4",numberOfLines:1,children:f,ref:a})}}),testid:"messenger_reaction_actor_"+c,addOnPrimary:{shape:"circle",size:40,source:{uri:b("bs_js_nlil_undefined").fromOption(e)},type:"profile-photo"},addOnSecondary:b("MWListCell.bs").SecondaryAddOn.body({addOn:a,type:"body"})};m!==void 0&&(h.meta=m);l!==void 0&&(h.onPress=b("bs_caml_option").valFromOption(l));return j.jsx(b("TetraAccessoryListCell.react"),h,c)}d={make:l};function m(a,b,c,d,e,f,g){return b.reduce(function(b,h){var i=a.get(h);if(i==nlil)return b.concat([j.jsx(k,{addOnIcon:e,id:h},h)]);else return b.concat([j.jsx(l,{actorId:i.contactId,profileUrl:i.profileUrl,profilePictureUrl:i.profilePictureUrl,actualName:i.actualName,messageID:d,reaction:c,sendOrRemoveReaction:f,currentUserStr:g,addOnIcon:e},h)])},[])}var n={content:{minHeight:"k3cnv2bo",maxHeight:"tenp0r9n",overflowX:"d76ob5m9",overflowY:"eg9m0zos"},num:{paddingStart:"qnrpqo6b"}};function o(a,c){var d=b("EmojiRenderer").parse(c).map(function(a){return a.emoji});if(d.length!==1)return j.jsx("span",{children:c});c=d[0];return j.jsx(b("CometEmoji.bs").make,{emoji:c,size:a})}function p(a){var c=a.onClose,d=a.threadKey,e=a.messageID,f=a.messageIDStr;a=b("MWThread_DEPRECATED.bs").useIdExn(void 0);var h=b("bs_curry")._1(b("MWUILoadParticipants.bs").useParticipants,a);a=j.useState(function(){return 0});var k=a[1],l=a[0],p=b("bs_curry")._1(b("MWUISendOrRemoveReaction.bs").useSendOrRemoveReaction,void 0),q=b("bs_int64").to_string(b("MWLSActor.bs").useActor(void 0)),r=b("ReStore.bs").useHook(void 0),s=b("ReQLSubscription.bs").useArray(j.useMemo(function(){return b("ReQL.bs").map(b("ReQL.bs").getKeyRange(b("SkytaleDB").table(r,"reactions").asc,{hd:d,tl:{hd:f,tl:0}}),function(a){return{a:a.a,b:a.b,c:a.c,d:a.d,e:b("MWChatReactionsUtils.bs").isHeart(a.e)?b("MWChatReactionsUtils.bs").heartType1:a.e,f:a.f}})},[JSON.stringify(d),f,r])).reduce(function(a,c){var d=[b("FBID.bs").ofStringExn(b("bs_int64").to_string(c.d))],e=b("bs_js_dict").get(a,c.e);e=e!==void 0?e.concat(d):d;a[c.e]=e;return a},{});a=b("bs_js_dict").values(s).reduce(function(b,a){return b+a.length|0},0);var t=[{label:g._("All {total reactions}",[g._param("total reactions",String(a))]),isActive:function(a){return l===0},onPress:function(a){return b("bs_curry")._1(k,function(a){return 0})}}];b("bs_js_dict").entries(s).sort(function(a,b){a=a[1].length;b=b[1].length;if(a>b)return-1;else if(a===b)return 0;else return 1}).forEach(function(a){var c=a[0];a=j.jsxs("div",{children:[o(20,c),j.jsx("span",{className:(i||(i=b("stylex")))(n.num),children:String(a[1].length)})]});t.push({label:a,isActive:function(a){return b("bs_caml_obj").caml_equal(l,{_0:c})},onPress:function(a){return b("bs_curry")._1(k,function(a){return{_0:c}})}})});j.useEffect(function(){return function(a){if(!l)return;a=b("bs_js_dict").get(s,l._0);if(a!==void 0)return;else return b("bs_curry")._1(k,function(a){return 0})}},[s]);if(l){a=l._0;var u=o(28,a),v=b("bs_js_dict").get(s,a);v=v!==void 0?m(h,v,a,e,u,p,q):nlil}else v=Object.keys(s).reduce(function(d,f){var c=b("bs_js_dict").get(s,f);if(c===void 0)return d;var a=o(28,f);c=m(h,c,f,e,a,p,q);return d.concat(c)},[]);return j.jsxs(b("CometCardedDialog.react"),{title:g._("Message Reactions"),withCloseButton:!0,onClose:c,children:[j.jsx(b("CometEntityHeaderTabBar.react"),{tabs:t}),j.jsx("div",{className:(i||(i=b("stylex")))(n.content),children:v})]})}e={make:p};function a(a){var c=a.onClose,d=a.reactions,e=a.threadKey;a=a.messageID;var f=b("MWChatMessageId.bs").getMessageId(a);if(f!==void 0)return j.jsx(p,{onClose:c,reactions:d,threadKey:e,messageID:a,messageIDStr:f});else return nlil}a=a;f.NoProfileWithReaction=c;f.ProfileWithReaction=d;f.renderActors=m;f.styles=n;f.renderReaction=o;f.Impl=e;f.make=a}),nlil);
__d("MWChatReactionsDialogCommon.bs",["cr:1936147"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1936147").make;f.$MWChatReactionsDialog$OR$MWChatReactionsDialog_DEPRECATED$requireCond=b("cr:1936147");f.make=a}),nlil);
__d("MWChatReactionsDialogCommon",["MWChatReactionsDialogCommon.bs"],(function(a,b,c,d,e,f,g){"use strict";g["defalit"]=d("MWChatReactionsDialogCommon.bs").make}),98);